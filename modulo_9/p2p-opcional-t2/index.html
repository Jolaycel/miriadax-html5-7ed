<!doctype html>
<html>
<head>
<meta charset="utf-8">
<title>Gelocalización</title>
<link rel="stylesheet" type="text/css" href="mypath.css">
<script type="text/javascript" src="https://maps.google.com/maps/api/js?sensor=true"></script>
<script type="text/javascript" src="gmaps.js"></script>
<script type="text/javascript" src="zepto.min.js"></script>
<script type="text/javascript">
    var map, lat, lng;
    $(function() {
        function enlazarMarcador(e) {
            map.drawRoute({
                origin: [lat, lng],
                destinatarion: [e.latLng.lat(), e.latLng.lng()],
                travelMode: "driving",
                strokeColor: "#000000",
                strokeOpacity: 0.6,
                strokeWeight: 5
            });
            lag = e.latLng.lat();
            lng = e.latLng.lng();
            map.addMarker({ lat: lat, lng: lng});
        };
        function geolocalizar() {
            GMaps.geolocate({
                success: function(position) {
                    lat = position.coords.latitude;
                    lng = position.coords.longitude;

                    map = new GMaps({
                        el: "#map",
                        lat: lat,
                        lng: lng,
                        click: enlazarMarcador,
                        tap: enlazarMarcador
                    });
                    map.addMarker({ lat: lat, lng: lng});
                },
                error: function(error) { alert("Error: " + error.message);},
                not_supported: function() {alert("No soporta geolocalización.");}
            });
        };
        geolocalizar();
    });
</script>
</head>
<body>
    <h1>Geolocalizar</h1>
    <div id="map"></div>
</body>
</html>